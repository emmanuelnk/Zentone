{"dependencies":[{"name":"/Users/terminallychill/Sites/zentone/package.json","includedInParent":true,"mtime":1524394439205},{"name":"/Users/terminallychill/Sites/zentone/node_modules/lusca/package.json","includedInParent":true,"mtime":1507055286000},{"name":"crypto","loc":{"line":19,"column":22}},{"name":"./lib/csrf","loc":{"line":69,"column":21}},{"name":"./lib/csp","loc":{"line":70,"column":20}},{"name":"./lib/hsts","loc":{"line":71,"column":21}},{"name":"./lib/p3p","loc":{"line":72,"column":20}},{"name":"./lib/xframes","loc":{"line":73,"column":23}},{"name":"./lib/xssprotection","loc":{"line":74,"column":30}},{"name":"./lib/nosniff","loc":{"line":75,"column":24}},{"name":"./lib/referrerpolicy","loc":{"line":76,"column":31}}],"generated":{"js":"/*───────────────────────────────────────────────────────────────────────────*\\\n│  Copyright (C) 2016 PayPal                                                  │\n│                                                                             │\n│hh ,'\"\"`.                                                                    │\n│  / _  _ \\  Licensed under the Apache License, Version 2.0 (the \"License\");  │\n│  |(@)(@)|  you may not use this file except in compliance with the License. │\n│  )  __  (  You may obtain a copy of the License at                          │\n│ /,'))((`.\\                                                                  │\n│(( ((  )) ))    http://www.apache.org/licenses/LICENSE-2.0                   │\n│ `\\ `)(' /'                                                                  │\n│                                                                             │\n│   Unless required by applicable law or agreed to in writing, software       │\n│   distributed under the License is distributed on an \"AS IS\" BASIS,         │\n│   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  │\n│   See the License for the specific language governing permissions and       │\n│   limitations under the License.                                            │\n\\*───────────────────────────────────────────────────────────────────────────*/\n'use strict';\n\nvar crypto = require('crypto');\n\n/**\n * Outputs all security headers based on configuration\n * @param {Object} options The configuration object.\n */\nvar lusca = module.exports = function (options) {\n    var headers = [];\n    var nonce;\n\n    if (options) {\n        Object.keys(lusca).forEach(function (key) {\n            var config = options[key];\n            if (key === \"csp\" && options[key] && (options[key]['styleNonce'] || options[key]['scriptNonce'])) {\n                nonce = true;\n            }\n\n            if (config) {\n                headers.push(lusca[key](config));\n            }\n        });\n    }\n\n    return function lusca(req, res, next) {\n        var chain = next;\n\n        if (nonce) {\n            Object.defineProperty(res.locals, 'nonce', {\n                value: crypto.pseudoRandomBytes(36).toString('base64'),\n                enumerable: true\n            });\n        }\n        headers.forEach(function (header) {\n            chain = function (next) {\n                return function (err) {\n                    if (err) {\n                        next(err);\n                        return;\n                    }\n                    return header(req, res, next);\n                };\n            }(chain);\n        });\n\n        chain();\n    };\n};\n\nlusca.csrf = require('./lib/csrf');\nlusca.csp = require('./lib/csp');\nlusca.hsts = require('./lib/hsts');\nlusca.p3p = require('./lib/p3p');\nlusca.xframe = require('./lib/xframes');\nlusca.xssProtection = require('./lib/xssprotection');\nlusca.nosniff = require('./lib/nosniff');\nlusca.referrerPolicy = require('./lib/referrerpolicy');","map":{"mappings":[{"generated":{"line":1,"column":0},"source":"node_modules/lusca/index.js","original":{"line":1,"column":0}},{"generated":{"line":18,"column":0},"source":"node_modules/lusca/index.js","original":{"line":18,"column":0}},{"generated":{"line":20,"column":0},"source":"node_modules/lusca/index.js","original":{"line":19,"column":0}},{"name":"crypto","generated":{"line":20,"column":4},"source":"node_modules/lusca/index.js","original":{"line":19,"column":4}},{"name":"require","generated":{"line":20,"column":13},"source":"node_modules/lusca/index.js","original":{"line":19,"column":14}},{"generated":{"line":20,"column":21},"source":"node_modules/lusca/index.js","original":{"line":19,"column":22}},{"generated":{"line":20,"column":29},"source":"node_modules/lusca/index.js","original":{"line":19,"column":14}},{"generated":{"line":20,"column":30},"source":"node_modules/lusca/index.js","original":{"line":19,"column":0}},{"generated":{"line":22,"column":0},"source":"node_modules/lusca/index.js","original":{"line":22,"column":0}},{"generated":{"line":26,"column":0},"source":"node_modules/lusca/index.js","original":{"line":26,"column":0}},{"name":"lusca","generated":{"line":26,"column":4},"source":"node_modules/lusca/index.js","original":{"line":26,"column":4}},{"name":"module","generated":{"line":26,"column":12},"source":"node_modules/lusca/index.js","original":{"line":26,"column":12}},{"name":"exports","generated":{"line":26,"column":19},"source":"node_modules/lusca/index.js","original":{"line":26,"column":19}},{"generated":{"line":26,"column":26},"source":"node_modules/lusca/index.js","original":{"line":26,"column":12}},{"generated":{"line":26,"column":29},"source":"node_modules/lusca/index.js","original":{"line":26,"column":29}},{"name":"options","generated":{"line":26,"column":39},"source":"node_modules/lusca/index.js","original":{"line":26,"column":39}},{"generated":{"line":26,"column":46},"source":"node_modules/lusca/index.js","original":{"line":26,"column":29}},{"generated":{"line":26,"column":48},"source":"node_modules/lusca/index.js","original":{"line":26,"column":48}},{"generated":{"line":27,"column":0},"source":"node_modules/lusca/index.js","original":{"line":27,"column":4}},{"name":"headers","generated":{"line":27,"column":8},"source":"node_modules/lusca/index.js","original":{"line":27,"column":8}},{"generated":{"line":27,"column":18},"source":"node_modules/lusca/index.js","original":{"line":27,"column":18}},{"generated":{"line":27,"column":20},"source":"node_modules/lusca/index.js","original":{"line":27,"column":4}},{"generated":{"line":28,"column":0},"source":"node_modules/lusca/index.js","original":{"line":28,"column":4}},{"name":"nonce","generated":{"line":28,"column":8},"source":"node_modules/lusca/index.js","original":{"line":28,"column":8}},{"generated":{"line":28,"column":13},"source":"node_modules/lusca/index.js","original":{"line":28,"column":4}},{"generated":{"line":30,"column":0},"source":"node_modules/lusca/index.js","original":{"line":30,"column":4}},{"name":"options","generated":{"line":30,"column":8},"source":"node_modules/lusca/index.js","original":{"line":30,"column":8}},{"generated":{"line":30,"column":15},"source":"node_modules/lusca/index.js","original":{"line":30,"column":4}},{"generated":{"line":30,"column":17},"source":"node_modules/lusca/index.js","original":{"line":30,"column":17}},{"name":"Object","generated":{"line":31,"column":0},"source":"node_modules/lusca/index.js","original":{"line":31,"column":8}},{"name":"keys","generated":{"line":31,"column":15},"source":"node_modules/lusca/index.js","original":{"line":31,"column":15}},{"generated":{"line":31,"column":19},"source":"node_modules/lusca/index.js","original":{"line":31,"column":8}},{"name":"lusca","generated":{"line":31,"column":20},"source":"node_modules/lusca/index.js","original":{"line":31,"column":20}},{"generated":{"line":31,"column":25},"source":"node_modules/lusca/index.js","original":{"line":31,"column":8}},{"name":"forEach","generated":{"line":31,"column":27},"source":"node_modules/lusca/index.js","original":{"line":31,"column":27}},{"generated":{"line":31,"column":34},"source":"node_modules/lusca/index.js","original":{"line":31,"column":8}},{"generated":{"line":31,"column":35},"source":"node_modules/lusca/index.js","original":{"line":31,"column":35}},{"name":"key","generated":{"line":31,"column":45},"source":"node_modules/lusca/index.js","original":{"line":31,"column":45}},{"generated":{"line":31,"column":48},"source":"node_modules/lusca/index.js","original":{"line":31,"column":35}},{"generated":{"line":31,"column":50},"source":"node_modules/lusca/index.js","original":{"line":31,"column":50}},{"generated":{"line":32,"column":0},"source":"node_modules/lusca/index.js","original":{"line":32,"column":12}},{"name":"config","generated":{"line":32,"column":16},"source":"node_modules/lusca/index.js","original":{"line":32,"column":16}},{"name":"options","generated":{"line":32,"column":25},"source":"node_modules/lusca/index.js","original":{"line":32,"column":25}},{"name":"key","generated":{"line":32,"column":33},"source":"node_modules/lusca/index.js","original":{"line":32,"column":33}},{"generated":{"line":32,"column":36},"source":"node_modules/lusca/index.js","original":{"line":32,"column":25}},{"generated":{"line":32,"column":37},"source":"node_modules/lusca/index.js","original":{"line":32,"column":12}},{"generated":{"line":33,"column":0},"source":"node_modules/lusca/index.js","original":{"line":33,"column":12}},{"name":"key","generated":{"line":33,"column":16},"source":"node_modules/lusca/index.js","original":{"line":33,"column":16}},{"generated":{"line":33,"column":24},"source":"node_modules/lusca/index.js","original":{"line":33,"column":24}},{"generated":{"line":33,"column":29},"source":"node_modules/lusca/index.js","original":{"line":33,"column":16}},{"name":"options","generated":{"line":33,"column":33},"source":"node_modules/lusca/index.js","original":{"line":33,"column":33}},{"name":"key","generated":{"line":33,"column":41},"source":"node_modules/lusca/index.js","original":{"line":33,"column":41}},{"generated":{"line":33,"column":44},"source":"node_modules/lusca/index.js","original":{"line":33,"column":33}},{"generated":{"line":33,"column":45},"source":"node_modules/lusca/index.js","original":{"line":33,"column":16}},{"name":"options","generated":{"line":33,"column":50},"source":"node_modules/lusca/index.js","original":{"line":33,"column":50}},{"name":"key","generated":{"line":33,"column":58},"source":"node_modules/lusca/index.js","original":{"line":33,"column":58}},{"generated":{"line":33,"column":61},"source":"node_modules/lusca/index.js","original":{"line":33,"column":50}},{"generated":{"line":33,"column":63},"source":"node_modules/lusca/index.js","original":{"line":33,"column":63}},{"generated":{"line":33,"column":75},"source":"node_modules/lusca/index.js","original":{"line":33,"column":50}},{"name":"options","generated":{"line":33,"column":80},"source":"node_modules/lusca/index.js","original":{"line":33,"column":80}},{"name":"key","generated":{"line":33,"column":88},"source":"node_modules/lusca/index.js","original":{"line":33,"column":88}},{"generated":{"line":33,"column":91},"source":"node_modules/lusca/index.js","original":{"line":33,"column":80}},{"generated":{"line":33,"column":93},"source":"node_modules/lusca/index.js","original":{"line":33,"column":93}},{"generated":{"line":33,"column":106},"source":"node_modules/lusca/index.js","original":{"line":33,"column":80}},{"generated":{"line":33,"column":107},"source":"node_modules/lusca/index.js","original":{"line":33,"column":16}},{"generated":{"line":33,"column":108},"source":"node_modules/lusca/index.js","original":{"line":33,"column":12}},{"generated":{"line":33,"column":110},"source":"node_modules/lusca/index.js","original":{"line":33,"column":110}},{"name":"nonce","generated":{"line":34,"column":0},"source":"node_modules/lusca/index.js","original":{"line":34,"column":16}},{"generated":{"line":34,"column":24},"source":"node_modules/lusca/index.js","original":{"line":34,"column":24}},{"generated":{"line":34,"column":28},"source":"node_modules/lusca/index.js","original":{"line":34,"column":16}},{"generated":{"line":35,"column":0},"source":"node_modules/lusca/index.js","original":{"line":35,"column":13}},{"generated":{"line":37,"column":0},"source":"node_modules/lusca/index.js","original":{"line":37,"column":12}},{"name":"config","generated":{"line":37,"column":16},"source":"node_modules/lusca/index.js","original":{"line":37,"column":16}},{"generated":{"line":37,"column":22},"source":"node_modules/lusca/index.js","original":{"line":37,"column":12}},{"generated":{"line":37,"column":24},"source":"node_modules/lusca/index.js","original":{"line":37,"column":24}},{"name":"headers","generated":{"line":38,"column":0},"source":"node_modules/lusca/index.js","original":{"line":38,"column":16}},{"name":"push","generated":{"line":38,"column":24},"source":"node_modules/lusca/index.js","original":{"line":38,"column":24}},{"generated":{"line":38,"column":28},"source":"node_modules/lusca/index.js","original":{"line":38,"column":16}},{"name":"lusca","generated":{"line":38,"column":29},"source":"node_modules/lusca/index.js","original":{"line":38,"column":29}},{"name":"key","generated":{"line":38,"column":35},"source":"node_modules/lusca/index.js","original":{"line":38,"column":35}},{"generated":{"line":38,"column":38},"source":"node_modules/lusca/index.js","original":{"line":38,"column":29}},{"name":"config","generated":{"line":38,"column":40},"source":"node_modules/lusca/index.js","original":{"line":38,"column":40}},{"generated":{"line":38,"column":46},"source":"node_modules/lusca/index.js","original":{"line":38,"column":29}},{"generated":{"line":38,"column":47},"source":"node_modules/lusca/index.js","original":{"line":38,"column":16}},{"generated":{"line":39,"column":0},"source":"node_modules/lusca/index.js","original":{"line":39,"column":13}},{"generated":{"line":40,"column":0},"source":"node_modules/lusca/index.js","original":{"line":40,"column":9}},{"generated":{"line":40,"column":9},"source":"node_modules/lusca/index.js","original":{"line":31,"column":8}},{"generated":{"line":41,"column":0},"source":"node_modules/lusca/index.js","original":{"line":41,"column":5}},{"generated":{"line":43,"column":0},"source":"node_modules/lusca/index.js","original":{"line":43,"column":4}},{"generated":{"line":43,"column":11},"source":"node_modules/lusca/index.js","original":{"line":43,"column":11}},{"name":"lusca","generated":{"line":43,"column":20},"source":"node_modules/lusca/index.js","original":{"line":43,"column":20}},{"generated":{"line":43,"column":25},"source":"node_modules/lusca/index.js","original":{"line":43,"column":11}},{"name":"req","generated":{"line":43,"column":26},"source":"node_modules/lusca/index.js","original":{"line":43,"column":26}},{"generated":{"line":43,"column":29},"source":"node_modules/lusca/index.js","original":{"line":43,"column":11}},{"name":"res","generated":{"line":43,"column":31},"source":"node_modules/lusca/index.js","original":{"line":43,"column":31}},{"generated":{"line":43,"column":34},"source":"node_modules/lusca/index.js","original":{"line":43,"column":11}},{"name":"next","generated":{"line":43,"column":36},"source":"node_modules/lusca/index.js","original":{"line":43,"column":36}},{"generated":{"line":43,"column":40},"source":"node_modules/lusca/index.js","original":{"line":43,"column":11}},{"generated":{"line":43,"column":42},"source":"node_modules/lusca/index.js","original":{"line":43,"column":42}},{"generated":{"line":44,"column":0},"source":"node_modules/lusca/index.js","original":{"line":44,"column":8}},{"name":"chain","generated":{"line":44,"column":12},"source":"node_modules/lusca/index.js","original":{"line":44,"column":12}},{"name":"next","generated":{"line":44,"column":20},"source":"node_modules/lusca/index.js","original":{"line":44,"column":20}},{"generated":{"line":44,"column":24},"source":"node_modules/lusca/index.js","original":{"line":44,"column":8}},{"generated":{"line":46,"column":0},"source":"node_modules/lusca/index.js","original":{"line":46,"column":8}},{"name":"nonce","generated":{"line":46,"column":12},"source":"node_modules/lusca/index.js","original":{"line":46,"column":12}},{"generated":{"line":46,"column":17},"source":"node_modules/lusca/index.js","original":{"line":46,"column":8}},{"generated":{"line":46,"column":19},"source":"node_modules/lusca/index.js","original":{"line":46,"column":19}},{"name":"Object","generated":{"line":47,"column":0},"source":"node_modules/lusca/index.js","original":{"line":47,"column":12}},{"name":"defineProperty","generated":{"line":47,"column":19},"source":"node_modules/lusca/index.js","original":{"line":47,"column":19}},{"generated":{"line":47,"column":33},"source":"node_modules/lusca/index.js","original":{"line":47,"column":12}},{"name":"res","generated":{"line":47,"column":34},"source":"node_modules/lusca/index.js","original":{"line":47,"column":34}},{"name":"locals","generated":{"line":47,"column":38},"source":"node_modules/lusca/index.js","original":{"line":47,"column":38}},{"generated":{"line":47,"column":44},"source":"node_modules/lusca/index.js","original":{"line":47,"column":12}},{"generated":{"line":47,"column":46},"source":"node_modules/lusca/index.js","original":{"line":47,"column":46}},{"generated":{"line":47,"column":53},"source":"node_modules/lusca/index.js","original":{"line":47,"column":12}},{"generated":{"line":47,"column":55},"source":"node_modules/lusca/index.js","original":{"line":47,"column":55}},{"name":"value","generated":{"line":48,"column":0},"source":"node_modules/lusca/index.js","original":{"line":48,"column":16}},{"name":"crypto","generated":{"line":48,"column":23},"source":"node_modules/lusca/index.js","original":{"line":48,"column":23}},{"name":"pseudoRandomBytes","generated":{"line":48,"column":30},"source":"node_modules/lusca/index.js","original":{"line":48,"column":30}},{"generated":{"line":48,"column":47},"source":"node_modules/lusca/index.js","original":{"line":48,"column":23}},{"generated":{"line":48,"column":48},"source":"node_modules/lusca/index.js","original":{"line":48,"column":48}},{"generated":{"line":48,"column":50},"source":"node_modules/lusca/index.js","original":{"line":48,"column":23}},{"name":"toString","generated":{"line":48,"column":52},"source":"node_modules/lusca/index.js","original":{"line":48,"column":52}},{"generated":{"line":48,"column":60},"source":"node_modules/lusca/index.js","original":{"line":48,"column":23}},{"generated":{"line":48,"column":61},"source":"node_modules/lusca/index.js","original":{"line":48,"column":61}},{"generated":{"line":48,"column":69},"source":"node_modules/lusca/index.js","original":{"line":48,"column":23}},{"generated":{"line":48,"column":70},"source":"node_modules/lusca/index.js","original":{"line":47,"column":55}},{"name":"enumerable","generated":{"line":49,"column":0},"source":"node_modules/lusca/index.js","original":{"line":49,"column":16}},{"generated":{"line":49,"column":28},"source":"node_modules/lusca/index.js","original":{"line":49,"column":28}},{"generated":{"line":50,"column":0},"source":"node_modules/lusca/index.js","original":{"line":47,"column":55}},{"generated":{"line":50,"column":13},"source":"node_modules/lusca/index.js","original":{"line":47,"column":12}},{"generated":{"line":51,"column":0},"source":"node_modules/lusca/index.js","original":{"line":51,"column":9}},{"name":"headers","generated":{"line":52,"column":0},"source":"node_modules/lusca/index.js","original":{"line":52,"column":8}},{"name":"forEach","generated":{"line":52,"column":16},"source":"node_modules/lusca/index.js","original":{"line":52,"column":16}},{"generated":{"line":52,"column":23},"source":"node_modules/lusca/index.js","original":{"line":52,"column":8}},{"generated":{"line":52,"column":24},"source":"node_modules/lusca/index.js","original":{"line":52,"column":24}},{"name":"header","generated":{"line":52,"column":34},"source":"node_modules/lusca/index.js","original":{"line":52,"column":34}},{"generated":{"line":52,"column":40},"source":"node_modules/lusca/index.js","original":{"line":52,"column":24}},{"generated":{"line":52,"column":42},"source":"node_modules/lusca/index.js","original":{"line":52,"column":42}},{"name":"chain","generated":{"line":53,"column":0},"source":"node_modules/lusca/index.js","original":{"line":53,"column":12}},{"generated":{"line":53,"column":20},"source":"node_modules/lusca/index.js","original":{"line":53,"column":21}},{"name":"next","generated":{"line":53,"column":30},"source":"node_modules/lusca/index.js","original":{"line":53,"column":31}},{"generated":{"line":53,"column":34},"source":"node_modules/lusca/index.js","original":{"line":53,"column":21}},{"generated":{"line":53,"column":36},"source":"node_modules/lusca/index.js","original":{"line":53,"column":37}},{"generated":{"line":54,"column":0},"source":"node_modules/lusca/index.js","original":{"line":54,"column":16}},{"generated":{"line":54,"column":23},"source":"node_modules/lusca/index.js","original":{"line":54,"column":23}},{"name":"err","generated":{"line":54,"column":33},"source":"node_modules/lusca/index.js","original":{"line":54,"column":33}},{"generated":{"line":54,"column":36},"source":"node_modules/lusca/index.js","original":{"line":54,"column":23}},{"generated":{"line":54,"column":38},"source":"node_modules/lusca/index.js","original":{"line":54,"column":38}},{"generated":{"line":55,"column":0},"source":"node_modules/lusca/index.js","original":{"line":55,"column":20}},{"name":"err","generated":{"line":55,"column":24},"source":"node_modules/lusca/index.js","original":{"line":55,"column":24}},{"generated":{"line":55,"column":27},"source":"node_modules/lusca/index.js","original":{"line":55,"column":20}},{"generated":{"line":55,"column":29},"source":"node_modules/lusca/index.js","original":{"line":55,"column":29}},{"name":"next","generated":{"line":56,"column":0},"source":"node_modules/lusca/index.js","original":{"line":56,"column":24}},{"name":"err","generated":{"line":56,"column":29},"source":"node_modules/lusca/index.js","original":{"line":56,"column":29}},{"generated":{"line":56,"column":32},"source":"node_modules/lusca/index.js","original":{"line":56,"column":24}},{"generated":{"line":57,"column":0},"source":"node_modules/lusca/index.js","original":{"line":57,"column":24}},{"generated":{"line":58,"column":0},"source":"node_modules/lusca/index.js","original":{"line":58,"column":21}},{"generated":{"line":59,"column":0},"source":"node_modules/lusca/index.js","original":{"line":59,"column":20}},{"name":"header","generated":{"line":59,"column":27},"source":"node_modules/lusca/index.js","original":{"line":59,"column":27}},{"name":"req","generated":{"line":59,"column":34},"source":"node_modules/lusca/index.js","original":{"line":59,"column":34}},{"generated":{"line":59,"column":37},"source":"node_modules/lusca/index.js","original":{"line":59,"column":27}},{"name":"res","generated":{"line":59,"column":39},"source":"node_modules/lusca/index.js","original":{"line":59,"column":39}},{"generated":{"line":59,"column":42},"source":"node_modules/lusca/index.js","original":{"line":59,"column":27}},{"name":"next","generated":{"line":59,"column":44},"source":"node_modules/lusca/index.js","original":{"line":59,"column":44}},{"generated":{"line":59,"column":48},"source":"node_modules/lusca/index.js","original":{"line":59,"column":27}},{"generated":{"line":59,"column":49},"source":"node_modules/lusca/index.js","original":{"line":59,"column":20}},{"generated":{"line":60,"column":0},"source":"node_modules/lusca/index.js","original":{"line":60,"column":17}},{"generated":{"line":60,"column":17},"source":"node_modules/lusca/index.js","original":{"line":54,"column":16}},{"generated":{"line":61,"column":0},"source":"node_modules/lusca/index.js","original":{"line":61,"column":13}},{"generated":{"line":61,"column":13},"source":"node_modules/lusca/index.js","original":{"line":53,"column":21}},{"name":"chain","generated":{"line":61,"column":14},"source":"node_modules/lusca/index.js","original":{"line":61,"column":14}},{"generated":{"line":61,"column":19},"source":"node_modules/lusca/index.js","original":{"line":53,"column":21}},{"generated":{"line":61,"column":20},"source":"node_modules/lusca/index.js","original":{"line":53,"column":12}},{"generated":{"line":62,"column":0},"source":"node_modules/lusca/index.js","original":{"line":62,"column":9}},{"generated":{"line":62,"column":9},"source":"node_modules/lusca/index.js","original":{"line":52,"column":8}},{"name":"chain","generated":{"line":64,"column":0},"source":"node_modules/lusca/index.js","original":{"line":64,"column":8}},{"generated":{"line":65,"column":0},"source":"node_modules/lusca/index.js","original":{"line":65,"column":5}},{"generated":{"line":65,"column":5},"source":"node_modules/lusca/index.js","original":{"line":43,"column":4}},{"generated":{"line":66,"column":0},"source":"node_modules/lusca/index.js","original":{"line":66,"column":1}},{"generated":{"line":66,"column":1},"source":"node_modules/lusca/index.js","original":{"line":26,"column":0}},{"name":"lusca","generated":{"line":68,"column":0},"source":"node_modules/lusca/index.js","original":{"line":69,"column":0}},{"name":"csrf","generated":{"line":68,"column":6},"source":"node_modules/lusca/index.js","original":{"line":69,"column":6}},{"generated":{"line":68,"column":10},"source":"node_modules/lusca/index.js","original":{"line":69,"column":0}},{"name":"require","generated":{"line":68,"column":13},"source":"node_modules/lusca/index.js","original":{"line":69,"column":13}},{"generated":{"line":68,"column":21},"source":"node_modules/lusca/index.js","original":{"line":69,"column":21}},{"generated":{"line":68,"column":33},"source":"node_modules/lusca/index.js","original":{"line":69,"column":13}},{"generated":{"line":68,"column":34},"source":"node_modules/lusca/index.js","original":{"line":69,"column":0}},{"name":"lusca","generated":{"line":69,"column":0},"source":"node_modules/lusca/index.js","original":{"line":70,"column":0}},{"name":"csp","generated":{"line":69,"column":6},"source":"node_modules/lusca/index.js","original":{"line":70,"column":6}},{"generated":{"line":69,"column":9},"source":"node_modules/lusca/index.js","original":{"line":70,"column":0}},{"name":"require","generated":{"line":69,"column":12},"source":"node_modules/lusca/index.js","original":{"line":70,"column":12}},{"generated":{"line":69,"column":20},"source":"node_modules/lusca/index.js","original":{"line":70,"column":20}},{"generated":{"line":69,"column":31},"source":"node_modules/lusca/index.js","original":{"line":70,"column":12}},{"generated":{"line":69,"column":32},"source":"node_modules/lusca/index.js","original":{"line":70,"column":0}},{"name":"lusca","generated":{"line":70,"column":0},"source":"node_modules/lusca/index.js","original":{"line":71,"column":0}},{"name":"hsts","generated":{"line":70,"column":6},"source":"node_modules/lusca/index.js","original":{"line":71,"column":6}},{"generated":{"line":70,"column":10},"source":"node_modules/lusca/index.js","original":{"line":71,"column":0}},{"name":"require","generated":{"line":70,"column":13},"source":"node_modules/lusca/index.js","original":{"line":71,"column":13}},{"generated":{"line":70,"column":21},"source":"node_modules/lusca/index.js","original":{"line":71,"column":21}},{"generated":{"line":70,"column":33},"source":"node_modules/lusca/index.js","original":{"line":71,"column":13}},{"generated":{"line":70,"column":34},"source":"node_modules/lusca/index.js","original":{"line":71,"column":0}},{"name":"lusca","generated":{"line":71,"column":0},"source":"node_modules/lusca/index.js","original":{"line":72,"column":0}},{"name":"p3p","generated":{"line":71,"column":6},"source":"node_modules/lusca/index.js","original":{"line":72,"column":6}},{"generated":{"line":71,"column":9},"source":"node_modules/lusca/index.js","original":{"line":72,"column":0}},{"name":"require","generated":{"line":71,"column":12},"source":"node_modules/lusca/index.js","original":{"line":72,"column":12}},{"generated":{"line":71,"column":20},"source":"node_modules/lusca/index.js","original":{"line":72,"column":20}},{"generated":{"line":71,"column":31},"source":"node_modules/lusca/index.js","original":{"line":72,"column":12}},{"generated":{"line":71,"column":32},"source":"node_modules/lusca/index.js","original":{"line":72,"column":0}},{"name":"lusca","generated":{"line":72,"column":0},"source":"node_modules/lusca/index.js","original":{"line":73,"column":0}},{"name":"xframe","generated":{"line":72,"column":6},"source":"node_modules/lusca/index.js","original":{"line":73,"column":6}},{"generated":{"line":72,"column":12},"source":"node_modules/lusca/index.js","original":{"line":73,"column":0}},{"name":"require","generated":{"line":72,"column":15},"source":"node_modules/lusca/index.js","original":{"line":73,"column":15}},{"generated":{"line":72,"column":23},"source":"node_modules/lusca/index.js","original":{"line":73,"column":23}},{"generated":{"line":72,"column":38},"source":"node_modules/lusca/index.js","original":{"line":73,"column":15}},{"generated":{"line":72,"column":39},"source":"node_modules/lusca/index.js","original":{"line":73,"column":0}},{"name":"lusca","generated":{"line":73,"column":0},"source":"node_modules/lusca/index.js","original":{"line":74,"column":0}},{"name":"xssProtection","generated":{"line":73,"column":6},"source":"node_modules/lusca/index.js","original":{"line":74,"column":6}},{"generated":{"line":73,"column":19},"source":"node_modules/lusca/index.js","original":{"line":74,"column":0}},{"name":"require","generated":{"line":73,"column":22},"source":"node_modules/lusca/index.js","original":{"line":74,"column":22}},{"generated":{"line":73,"column":30},"source":"node_modules/lusca/index.js","original":{"line":74,"column":30}},{"generated":{"line":73,"column":51},"source":"node_modules/lusca/index.js","original":{"line":74,"column":22}},{"generated":{"line":73,"column":52},"source":"node_modules/lusca/index.js","original":{"line":74,"column":0}},{"name":"lusca","generated":{"line":74,"column":0},"source":"node_modules/lusca/index.js","original":{"line":75,"column":0}},{"name":"nosniff","generated":{"line":74,"column":6},"source":"node_modules/lusca/index.js","original":{"line":75,"column":6}},{"generated":{"line":74,"column":13},"source":"node_modules/lusca/index.js","original":{"line":75,"column":0}},{"name":"require","generated":{"line":74,"column":16},"source":"node_modules/lusca/index.js","original":{"line":75,"column":16}},{"generated":{"line":74,"column":24},"source":"node_modules/lusca/index.js","original":{"line":75,"column":24}},{"generated":{"line":74,"column":39},"source":"node_modules/lusca/index.js","original":{"line":75,"column":16}},{"generated":{"line":74,"column":40},"source":"node_modules/lusca/index.js","original":{"line":75,"column":0}},{"name":"lusca","generated":{"line":75,"column":0},"source":"node_modules/lusca/index.js","original":{"line":76,"column":0}},{"name":"referrerPolicy","generated":{"line":75,"column":6},"source":"node_modules/lusca/index.js","original":{"line":76,"column":6}},{"generated":{"line":75,"column":20},"source":"node_modules/lusca/index.js","original":{"line":76,"column":0}},{"name":"require","generated":{"line":75,"column":23},"source":"node_modules/lusca/index.js","original":{"line":76,"column":23}},{"generated":{"line":75,"column":31},"source":"node_modules/lusca/index.js","original":{"line":76,"column":31}},{"generated":{"line":75,"column":53},"source":"node_modules/lusca/index.js","original":{"line":76,"column":23}},{"generated":{"line":75,"column":54},"source":"node_modules/lusca/index.js","original":{"line":76,"column":0}}],"sources":{"node_modules/lusca/index.js":"/*───────────────────────────────────────────────────────────────────────────*\\\n│  Copyright (C) 2016 PayPal                                                  │\n│                                                                             │\n│hh ,'\"\"`.                                                                    │\n│  / _  _ \\  Licensed under the Apache License, Version 2.0 (the \"License\");  │\n│  |(@)(@)|  you may not use this file except in compliance with the License. │\n│  )  __  (  You may obtain a copy of the License at                          │\n│ /,'))((`.\\                                                                  │\n│(( ((  )) ))    http://www.apache.org/licenses/LICENSE-2.0                   │\n│ `\\ `)(' /'                                                                  │\n│                                                                             │\n│   Unless required by applicable law or agreed to in writing, software       │\n│   distributed under the License is distributed on an \"AS IS\" BASIS,         │\n│   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.  │\n│   See the License for the specific language governing permissions and       │\n│   limitations under the License.                                            │\n\\*───────────────────────────────────────────────────────────────────────────*/\n'use strict';\nvar crypto  = require('crypto');\n\n\n/**\n * Outputs all security headers based on configuration\n * @param {Object} options The configuration object.\n */\nvar lusca = module.exports = function (options) {\n    var headers = [];\n    var nonce;\n\n    if (options) {\n        Object.keys(lusca).forEach(function (key) {\n            var config = options[key];\n            if (key === \"csp\" && options[key] && (options[key]['styleNonce'] || options[key]['scriptNonce'])) {\n                nonce = true;\n            }\n\n            if (config) {\n                headers.push(lusca[key](config));\n            }\n        });\n    }\n\n    return function lusca(req, res, next) {\n        var chain = next;\n\n        if (nonce) {\n            Object.defineProperty(res.locals, 'nonce', {\n                value: crypto.pseudoRandomBytes(36).toString('base64'),\n                enumerable: true\n            });\n        }\n        headers.forEach(function (header) {\n            chain = (function (next) {\n                return function (err) {\n                    if (err) {\n                        next(err);\n                        return;\n                    }\n                    return header(req, res, next);\n                };\n            }(chain));\n        });\n\n        chain();\n    };\n};\n\n\nlusca.csrf = require('./lib/csrf');\nlusca.csp = require('./lib/csp');\nlusca.hsts = require('./lib/hsts');\nlusca.p3p = require('./lib/p3p');\nlusca.xframe = require('./lib/xframes');\nlusca.xssProtection = require('./lib/xssprotection');\nlusca.nosniff = require('./lib/nosniff');\nlusca.referrerPolicy = require('./lib/referrerpolicy');\n"},"lineCount":null}},"hash":"31675635331cdf7fc939d9940ed0e7a8","cacheData":{"env":{}}}