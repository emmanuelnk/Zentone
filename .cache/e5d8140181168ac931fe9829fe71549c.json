{"dependencies":[{"name":"/Users/terminallychill/Sites/zentone/package.json","includedInParent":true,"mtime":1524394439205},{"name":"/Users/terminallychill/Sites/zentone/node_modules/lusca/package.json","includedInParent":true,"mtime":1507055286000},{"name":"./token","loc":{"line":4,"column":20}},{"name":"tsscmp","loc":{"line":5,"column":30}}],"generated":{"js":"'use strict';\n\nvar token = require('./token'),\n    timeSafeCompare = require('tsscmp');\n\n/**\n * CSRF\n * https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)\n * @param {Object} options\n *    key {String} The name of the CSRF token in the model. Default \"_csrf\".\n *    impl {Object} An object with create/validate methods for custom tokens. Optional.\n *    header {String} The name of the response header containing the CSRF token. Default \"x-csrf-token\".\n */\nmodule.exports = function (options) {\n    var impl, key, header, secret, cookie;\n\n    options = options || {};\n\n    if (options.angular) {\n        options.header = 'X-XSRF-TOKEN';\n        options.cookie = {\n            name: 'XSRF-TOKEN',\n            options: options.cookie && options.cookie.options\n        };\n    }\n\n    key = options.key || '_csrf';\n    impl = options.impl || token;\n    header = options.header || 'x-csrf-token';\n    secret = options.secret || '_csrfSecret';\n\n    // Check if cookie is string or object\n    if (typeof options.cookie === 'string') {\n        cookie = {\n            name: options.cookie\n        };\n    } else {\n        cookie = {\n            name: options.cookie && options.cookie.name\n        };\n    }\n\n    // Set cookie options\n    cookie.options = options.cookie && options.cookie.options || {};\n\n    function getCsrf(req, secret) {\n        var _impl, validate, _token, _secret;\n\n        _impl = impl.create(req, secret);\n        validate = impl.validate || _impl.validate;\n        _token = _impl.token || _impl;\n        _secret = _impl.secret;\n\n        return {\n            validate: validate,\n            token: _token,\n            secret: _secret\n        };\n    }\n\n    function setToken(res, token) {\n        res.locals[key] = token;\n\n        if (cookie && cookie.name) {\n            res.cookie(cookie.name, token, cookie.options || {});\n        }\n    }\n\n    return function checkCsrf(req, res, next) {\n        var method, _token, errmsg;\n\n        var csrf = getCsrf(req, secret);\n\n        setToken(res, csrf.token);\n\n        req.csrfToken = function csrfToken() {\n            var newCsrf = getCsrf(req, secret);\n            if (csrf.secret && newCsrf.secret && timeSafeCompare(csrf.secret, newCsrf.secret)) {\n                return csrf.token;\n            }\n\n            csrf = newCsrf;\n            setToken(res, csrf.token);\n            return csrf.token;\n        };\n\n        // Move along for safe verbs\n        method = req.method;\n\n        if (method === 'GET' || method === 'HEAD' || method === 'OPTIONS') {\n            return next();\n        }\n\n        // Validate token\n        _token = req.body && req.body[key] || req.headers[header.toLowerCase()];\n\n        if (csrf.validate(req, _token)) {\n            next();\n        } else {\n            res.statusCode = 403;\n\n            if (!_token) {\n                errmsg = 'CSRF token missing';\n            } else {\n                errmsg = 'CSRF token mismatch';\n            }\n\n            next(new Error(errmsg));\n        }\n    };\n};","map":{"mappings":[{"generated":{"line":1,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":1,"column":0}},{"generated":{"line":3,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":4,"column":0}},{"name":"token","generated":{"line":3,"column":4},"source":"node_modules/lusca/lib/csrf.js","original":{"line":4,"column":4}},{"name":"require","generated":{"line":3,"column":12},"source":"node_modules/lusca/lib/csrf.js","original":{"line":4,"column":12}},{"generated":{"line":3,"column":20},"source":"node_modules/lusca/lib/csrf.js","original":{"line":4,"column":20}},{"generated":{"line":3,"column":29},"source":"node_modules/lusca/lib/csrf.js","original":{"line":4,"column":12}},{"generated":{"line":3,"column":30},"source":"node_modules/lusca/lib/csrf.js","original":{"line":4,"column":0}},{"generated":{"line":4,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":4,"column":0}},{"name":"timeSafeCompare","generated":{"line":4,"column":4},"source":"node_modules/lusca/lib/csrf.js","original":{"line":5,"column":4}},{"name":"require","generated":{"line":4,"column":22},"source":"node_modules/lusca/lib/csrf.js","original":{"line":5,"column":22}},{"generated":{"line":4,"column":30},"source":"node_modules/lusca/lib/csrf.js","original":{"line":5,"column":30}},{"generated":{"line":4,"column":38},"source":"node_modules/lusca/lib/csrf.js","original":{"line":5,"column":22}},{"generated":{"line":4,"column":39},"source":"node_modules/lusca/lib/csrf.js","original":{"line":4,"column":0}},{"generated":{"line":6,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":8,"column":0}},{"name":"module","generated":{"line":14,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":16,"column":0}},{"name":"exports","generated":{"line":14,"column":7},"source":"node_modules/lusca/lib/csrf.js","original":{"line":16,"column":7}},{"generated":{"line":14,"column":14},"source":"node_modules/lusca/lib/csrf.js","original":{"line":16,"column":0}},{"generated":{"line":14,"column":17},"source":"node_modules/lusca/lib/csrf.js","original":{"line":16,"column":17}},{"name":"options","generated":{"line":14,"column":27},"source":"node_modules/lusca/lib/csrf.js","original":{"line":16,"column":27}},{"generated":{"line":14,"column":34},"source":"node_modules/lusca/lib/csrf.js","original":{"line":16,"column":17}},{"generated":{"line":14,"column":36},"source":"node_modules/lusca/lib/csrf.js","original":{"line":16,"column":36}},{"generated":{"line":15,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":17,"column":4}},{"name":"impl","generated":{"line":15,"column":8},"source":"node_modules/lusca/lib/csrf.js","original":{"line":17,"column":8}},{"generated":{"line":15,"column":12},"source":"node_modules/lusca/lib/csrf.js","original":{"line":17,"column":4}},{"name":"key","generated":{"line":15,"column":14},"source":"node_modules/lusca/lib/csrf.js","original":{"line":17,"column":14}},{"generated":{"line":15,"column":17},"source":"node_modules/lusca/lib/csrf.js","original":{"line":17,"column":4}},{"name":"header","generated":{"line":15,"column":19},"source":"node_modules/lusca/lib/csrf.js","original":{"line":17,"column":19}},{"generated":{"line":15,"column":25},"source":"node_modules/lusca/lib/csrf.js","original":{"line":17,"column":4}},{"name":"secret","generated":{"line":15,"column":27},"source":"node_modules/lusca/lib/csrf.js","original":{"line":17,"column":27}},{"generated":{"line":15,"column":33},"source":"node_modules/lusca/lib/csrf.js","original":{"line":17,"column":4}},{"name":"cookie","generated":{"line":15,"column":35},"source":"node_modules/lusca/lib/csrf.js","original":{"line":17,"column":35}},{"generated":{"line":15,"column":41},"source":"node_modules/lusca/lib/csrf.js","original":{"line":17,"column":4}},{"name":"options","generated":{"line":17,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":19,"column":4}},{"name":"options","generated":{"line":17,"column":14},"source":"node_modules/lusca/lib/csrf.js","original":{"line":19,"column":14}},{"generated":{"line":17,"column":25},"source":"node_modules/lusca/lib/csrf.js","original":{"line":19,"column":25}},{"generated":{"line":17,"column":27},"source":"node_modules/lusca/lib/csrf.js","original":{"line":19,"column":4}},{"generated":{"line":19,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":21,"column":4}},{"name":"options","generated":{"line":19,"column":8},"source":"node_modules/lusca/lib/csrf.js","original":{"line":21,"column":8}},{"name":"angular","generated":{"line":19,"column":16},"source":"node_modules/lusca/lib/csrf.js","original":{"line":21,"column":16}},{"generated":{"line":19,"column":23},"source":"node_modules/lusca/lib/csrf.js","original":{"line":21,"column":4}},{"generated":{"line":19,"column":25},"source":"node_modules/lusca/lib/csrf.js","original":{"line":21,"column":25}},{"name":"options","generated":{"line":20,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":22,"column":8}},{"name":"header","generated":{"line":20,"column":16},"source":"node_modules/lusca/lib/csrf.js","original":{"line":22,"column":16}},{"generated":{"line":20,"column":22},"source":"node_modules/lusca/lib/csrf.js","original":{"line":22,"column":8}},{"generated":{"line":20,"column":25},"source":"node_modules/lusca/lib/csrf.js","original":{"line":22,"column":25}},{"generated":{"line":20,"column":39},"source":"node_modules/lusca/lib/csrf.js","original":{"line":22,"column":8}},{"name":"options","generated":{"line":21,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":23,"column":8}},{"name":"cookie","generated":{"line":21,"column":16},"source":"node_modules/lusca/lib/csrf.js","original":{"line":23,"column":16}},{"generated":{"line":21,"column":22},"source":"node_modules/lusca/lib/csrf.js","original":{"line":23,"column":8}},{"generated":{"line":21,"column":25},"source":"node_modules/lusca/lib/csrf.js","original":{"line":23,"column":25}},{"name":"name","generated":{"line":22,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":24,"column":12}},{"generated":{"line":22,"column":18},"source":"node_modules/lusca/lib/csrf.js","original":{"line":24,"column":18}},{"generated":{"line":22,"column":30},"source":"node_modules/lusca/lib/csrf.js","original":{"line":23,"column":25}},{"name":"options","generated":{"line":23,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":25,"column":12}},{"name":"options","generated":{"line":23,"column":21},"source":"node_modules/lusca/lib/csrf.js","original":{"line":25,"column":21}},{"name":"cookie","generated":{"line":23,"column":29},"source":"node_modules/lusca/lib/csrf.js","original":{"line":25,"column":29}},{"generated":{"line":23,"column":35},"source":"node_modules/lusca/lib/csrf.js","original":{"line":25,"column":21}},{"name":"options","generated":{"line":23,"column":39},"source":"node_modules/lusca/lib/csrf.js","original":{"line":25,"column":39}},{"name":"cookie","generated":{"line":23,"column":47},"source":"node_modules/lusca/lib/csrf.js","original":{"line":25,"column":47}},{"generated":{"line":23,"column":53},"source":"node_modules/lusca/lib/csrf.js","original":{"line":25,"column":39}},{"name":"options","generated":{"line":23,"column":54},"source":"node_modules/lusca/lib/csrf.js","original":{"line":25,"column":54}},{"generated":{"line":24,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":23,"column":25}},{"generated":{"line":24,"column":9},"source":"node_modules/lusca/lib/csrf.js","original":{"line":23,"column":8}},{"generated":{"line":25,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":27,"column":5}},{"name":"key","generated":{"line":27,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":29,"column":4}},{"name":"options","generated":{"line":27,"column":10},"source":"node_modules/lusca/lib/csrf.js","original":{"line":29,"column":10}},{"name":"key","generated":{"line":27,"column":18},"source":"node_modules/lusca/lib/csrf.js","original":{"line":29,"column":18}},{"generated":{"line":27,"column":21},"source":"node_modules/lusca/lib/csrf.js","original":{"line":29,"column":10}},{"generated":{"line":27,"column":25},"source":"node_modules/lusca/lib/csrf.js","original":{"line":29,"column":25}},{"generated":{"line":27,"column":32},"source":"node_modules/lusca/lib/csrf.js","original":{"line":29,"column":4}},{"name":"impl","generated":{"line":28,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":30,"column":4}},{"name":"options","generated":{"line":28,"column":11},"source":"node_modules/lusca/lib/csrf.js","original":{"line":30,"column":11}},{"name":"impl","generated":{"line":28,"column":19},"source":"node_modules/lusca/lib/csrf.js","original":{"line":30,"column":19}},{"generated":{"line":28,"column":23},"source":"node_modules/lusca/lib/csrf.js","original":{"line":30,"column":11}},{"name":"token","generated":{"line":28,"column":27},"source":"node_modules/lusca/lib/csrf.js","original":{"line":30,"column":27}},{"generated":{"line":28,"column":32},"source":"node_modules/lusca/lib/csrf.js","original":{"line":30,"column":4}},{"name":"header","generated":{"line":29,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":31,"column":4}},{"name":"options","generated":{"line":29,"column":13},"source":"node_modules/lusca/lib/csrf.js","original":{"line":31,"column":13}},{"name":"header","generated":{"line":29,"column":21},"source":"node_modules/lusca/lib/csrf.js","original":{"line":31,"column":21}},{"generated":{"line":29,"column":27},"source":"node_modules/lusca/lib/csrf.js","original":{"line":31,"column":13}},{"generated":{"line":29,"column":31},"source":"node_modules/lusca/lib/csrf.js","original":{"line":31,"column":31}},{"generated":{"line":29,"column":45},"source":"node_modules/lusca/lib/csrf.js","original":{"line":31,"column":4}},{"name":"secret","generated":{"line":30,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":32,"column":4}},{"name":"options","generated":{"line":30,"column":13},"source":"node_modules/lusca/lib/csrf.js","original":{"line":32,"column":13}},{"name":"secret","generated":{"line":30,"column":21},"source":"node_modules/lusca/lib/csrf.js","original":{"line":32,"column":21}},{"generated":{"line":30,"column":27},"source":"node_modules/lusca/lib/csrf.js","original":{"line":32,"column":13}},{"generated":{"line":30,"column":31},"source":"node_modules/lusca/lib/csrf.js","original":{"line":32,"column":31}},{"generated":{"line":30,"column":44},"source":"node_modules/lusca/lib/csrf.js","original":{"line":32,"column":4}},{"generated":{"line":32,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":34,"column":4}},{"generated":{"line":33,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":35,"column":4}},{"generated":{"line":33,"column":8},"source":"node_modules/lusca/lib/csrf.js","original":{"line":35,"column":8}},{"name":"options","generated":{"line":33,"column":15},"source":"node_modules/lusca/lib/csrf.js","original":{"line":35,"column":15}},{"name":"cookie","generated":{"line":33,"column":23},"source":"node_modules/lusca/lib/csrf.js","original":{"line":35,"column":23}},{"generated":{"line":33,"column":29},"source":"node_modules/lusca/lib/csrf.js","original":{"line":35,"column":8}},{"generated":{"line":33,"column":34},"source":"node_modules/lusca/lib/csrf.js","original":{"line":35,"column":34}},{"generated":{"line":33,"column":42},"source":"node_modules/lusca/lib/csrf.js","original":{"line":35,"column":4}},{"generated":{"line":33,"column":44},"source":"node_modules/lusca/lib/csrf.js","original":{"line":35,"column":44}},{"name":"cookie","generated":{"line":34,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":36,"column":8}},{"generated":{"line":34,"column":17},"source":"node_modules/lusca/lib/csrf.js","original":{"line":36,"column":17}},{"name":"name","generated":{"line":35,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":37,"column":12}},{"name":"options","generated":{"line":35,"column":18},"source":"node_modules/lusca/lib/csrf.js","original":{"line":37,"column":18}},{"name":"cookie","generated":{"line":35,"column":26},"source":"node_modules/lusca/lib/csrf.js","original":{"line":37,"column":26}},{"generated":{"line":36,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":36,"column":17}},{"generated":{"line":36,"column":9},"source":"node_modules/lusca/lib/csrf.js","original":{"line":36,"column":8}},{"generated":{"line":37,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":39,"column":5}},{"generated":{"line":37,"column":5},"source":"node_modules/lusca/lib/csrf.js","original":{"line":35,"column":4}},{"generated":{"line":37,"column":11},"source":"node_modules/lusca/lib/csrf.js","original":{"line":39,"column":11}},{"name":"cookie","generated":{"line":38,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":40,"column":8}},{"generated":{"line":38,"column":17},"source":"node_modules/lusca/lib/csrf.js","original":{"line":40,"column":17}},{"name":"name","generated":{"line":39,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":41,"column":12}},{"name":"options","generated":{"line":39,"column":18},"source":"node_modules/lusca/lib/csrf.js","original":{"line":41,"column":18}},{"name":"cookie","generated":{"line":39,"column":26},"source":"node_modules/lusca/lib/csrf.js","original":{"line":41,"column":26}},{"generated":{"line":39,"column":32},"source":"node_modules/lusca/lib/csrf.js","original":{"line":41,"column":18}},{"name":"options","generated":{"line":39,"column":36},"source":"node_modules/lusca/lib/csrf.js","original":{"line":41,"column":36}},{"name":"cookie","generated":{"line":39,"column":44},"source":"node_modules/lusca/lib/csrf.js","original":{"line":41,"column":44}},{"generated":{"line":39,"column":50},"source":"node_modules/lusca/lib/csrf.js","original":{"line":41,"column":36}},{"name":"name","generated":{"line":39,"column":51},"source":"node_modules/lusca/lib/csrf.js","original":{"line":41,"column":51}},{"generated":{"line":40,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":40,"column":17}},{"generated":{"line":40,"column":9},"source":"node_modules/lusca/lib/csrf.js","original":{"line":40,"column":8}},{"generated":{"line":41,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":43,"column":5}},{"generated":{"line":43,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":45,"column":4}},{"name":"cookie","generated":{"line":44,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":46,"column":4}},{"name":"options","generated":{"line":44,"column":11},"source":"node_modules/lusca/lib/csrf.js","original":{"line":46,"column":11}},{"generated":{"line":44,"column":18},"source":"node_modules/lusca/lib/csrf.js","original":{"line":46,"column":4}},{"name":"options","generated":{"line":44,"column":21},"source":"node_modules/lusca/lib/csrf.js","original":{"line":46,"column":21}},{"name":"cookie","generated":{"line":44,"column":29},"source":"node_modules/lusca/lib/csrf.js","original":{"line":46,"column":29}},{"generated":{"line":44,"column":35},"source":"node_modules/lusca/lib/csrf.js","original":{"line":46,"column":21}},{"name":"options","generated":{"line":44,"column":39},"source":"node_modules/lusca/lib/csrf.js","original":{"line":46,"column":39}},{"name":"cookie","generated":{"line":44,"column":47},"source":"node_modules/lusca/lib/csrf.js","original":{"line":46,"column":47}},{"generated":{"line":44,"column":53},"source":"node_modules/lusca/lib/csrf.js","original":{"line":46,"column":39}},{"name":"options","generated":{"line":44,"column":54},"source":"node_modules/lusca/lib/csrf.js","original":{"line":46,"column":54}},{"generated":{"line":44,"column":61},"source":"node_modules/lusca/lib/csrf.js","original":{"line":46,"column":21}},{"generated":{"line":44,"column":65},"source":"node_modules/lusca/lib/csrf.js","original":{"line":46,"column":65}},{"generated":{"line":44,"column":67},"source":"node_modules/lusca/lib/csrf.js","original":{"line":46,"column":4}},{"generated":{"line":46,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":48,"column":4}},{"name":"getCsrf","generated":{"line":46,"column":13},"source":"node_modules/lusca/lib/csrf.js","original":{"line":48,"column":13}},{"generated":{"line":46,"column":20},"source":"node_modules/lusca/lib/csrf.js","original":{"line":48,"column":4}},{"name":"req","generated":{"line":46,"column":21},"source":"node_modules/lusca/lib/csrf.js","original":{"line":48,"column":21}},{"generated":{"line":46,"column":24},"source":"node_modules/lusca/lib/csrf.js","original":{"line":48,"column":4}},{"name":"secret","generated":{"line":46,"column":26},"source":"node_modules/lusca/lib/csrf.js","original":{"line":48,"column":26}},{"generated":{"line":46,"column":32},"source":"node_modules/lusca/lib/csrf.js","original":{"line":48,"column":4}},{"generated":{"line":46,"column":34},"source":"node_modules/lusca/lib/csrf.js","original":{"line":48,"column":34}},{"generated":{"line":47,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":49,"column":8}},{"name":"_impl","generated":{"line":47,"column":12},"source":"node_modules/lusca/lib/csrf.js","original":{"line":49,"column":12}},{"generated":{"line":47,"column":17},"source":"node_modules/lusca/lib/csrf.js","original":{"line":49,"column":8}},{"name":"validate","generated":{"line":47,"column":19},"source":"node_modules/lusca/lib/csrf.js","original":{"line":49,"column":19}},{"generated":{"line":47,"column":27},"source":"node_modules/lusca/lib/csrf.js","original":{"line":49,"column":8}},{"name":"_token","generated":{"line":47,"column":29},"source":"node_modules/lusca/lib/csrf.js","original":{"line":49,"column":29}},{"generated":{"line":47,"column":35},"source":"node_modules/lusca/lib/csrf.js","original":{"line":49,"column":8}},{"name":"_secret","generated":{"line":47,"column":37},"source":"node_modules/lusca/lib/csrf.js","original":{"line":49,"column":37}},{"generated":{"line":47,"column":44},"source":"node_modules/lusca/lib/csrf.js","original":{"line":49,"column":8}},{"name":"_impl","generated":{"line":49,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":51,"column":8}},{"name":"impl","generated":{"line":49,"column":16},"source":"node_modules/lusca/lib/csrf.js","original":{"line":51,"column":16}},{"name":"create","generated":{"line":49,"column":21},"source":"node_modules/lusca/lib/csrf.js","original":{"line":51,"column":21}},{"generated":{"line":49,"column":27},"source":"node_modules/lusca/lib/csrf.js","original":{"line":51,"column":16}},{"name":"req","generated":{"line":49,"column":28},"source":"node_modules/lusca/lib/csrf.js","original":{"line":51,"column":28}},{"generated":{"line":49,"column":31},"source":"node_modules/lusca/lib/csrf.js","original":{"line":51,"column":16}},{"name":"secret","generated":{"line":49,"column":33},"source":"node_modules/lusca/lib/csrf.js","original":{"line":51,"column":33}},{"generated":{"line":49,"column":39},"source":"node_modules/lusca/lib/csrf.js","original":{"line":51,"column":16}},{"generated":{"line":49,"column":40},"source":"node_modules/lusca/lib/csrf.js","original":{"line":51,"column":8}},{"name":"validate","generated":{"line":50,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":52,"column":8}},{"name":"impl","generated":{"line":50,"column":19},"source":"node_modules/lusca/lib/csrf.js","original":{"line":52,"column":19}},{"name":"validate","generated":{"line":50,"column":24},"source":"node_modules/lusca/lib/csrf.js","original":{"line":52,"column":24}},{"generated":{"line":50,"column":32},"source":"node_modules/lusca/lib/csrf.js","original":{"line":52,"column":19}},{"name":"_impl","generated":{"line":50,"column":36},"source":"node_modules/lusca/lib/csrf.js","original":{"line":52,"column":36}},{"name":"validate","generated":{"line":50,"column":42},"source":"node_modules/lusca/lib/csrf.js","original":{"line":52,"column":42}},{"generated":{"line":50,"column":50},"source":"node_modules/lusca/lib/csrf.js","original":{"line":52,"column":8}},{"name":"_token","generated":{"line":51,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":53,"column":8}},{"name":"_impl","generated":{"line":51,"column":17},"source":"node_modules/lusca/lib/csrf.js","original":{"line":53,"column":17}},{"name":"token","generated":{"line":51,"column":23},"source":"node_modules/lusca/lib/csrf.js","original":{"line":53,"column":23}},{"generated":{"line":51,"column":28},"source":"node_modules/lusca/lib/csrf.js","original":{"line":53,"column":17}},{"name":"_impl","generated":{"line":51,"column":32},"source":"node_modules/lusca/lib/csrf.js","original":{"line":53,"column":32}},{"generated":{"line":51,"column":37},"source":"node_modules/lusca/lib/csrf.js","original":{"line":53,"column":8}},{"name":"_secret","generated":{"line":52,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":54,"column":8}},{"name":"_impl","generated":{"line":52,"column":18},"source":"node_modules/lusca/lib/csrf.js","original":{"line":54,"column":18}},{"name":"secret","generated":{"line":52,"column":24},"source":"node_modules/lusca/lib/csrf.js","original":{"line":54,"column":24}},{"generated":{"line":52,"column":30},"source":"node_modules/lusca/lib/csrf.js","original":{"line":54,"column":8}},{"generated":{"line":54,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":56,"column":8}},{"generated":{"line":54,"column":15},"source":"node_modules/lusca/lib/csrf.js","original":{"line":56,"column":15}},{"name":"validate","generated":{"line":55,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":57,"column":12}},{"name":"validate","generated":{"line":55,"column":22},"source":"node_modules/lusca/lib/csrf.js","original":{"line":57,"column":22}},{"generated":{"line":55,"column":30},"source":"node_modules/lusca/lib/csrf.js","original":{"line":56,"column":15}},{"name":"token","generated":{"line":56,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":58,"column":12}},{"name":"_token","generated":{"line":56,"column":19},"source":"node_modules/lusca/lib/csrf.js","original":{"line":58,"column":19}},{"generated":{"line":56,"column":25},"source":"node_modules/lusca/lib/csrf.js","original":{"line":56,"column":15}},{"name":"secret","generated":{"line":57,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":59,"column":12}},{"name":"_secret","generated":{"line":57,"column":20},"source":"node_modules/lusca/lib/csrf.js","original":{"line":59,"column":20}},{"generated":{"line":58,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":56,"column":15}},{"generated":{"line":58,"column":9},"source":"node_modules/lusca/lib/csrf.js","original":{"line":56,"column":8}},{"generated":{"line":59,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":61,"column":5}},{"generated":{"line":61,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":63,"column":4}},{"name":"setToken","generated":{"line":61,"column":13},"source":"node_modules/lusca/lib/csrf.js","original":{"line":63,"column":13}},{"generated":{"line":61,"column":21},"source":"node_modules/lusca/lib/csrf.js","original":{"line":63,"column":4}},{"name":"res","generated":{"line":61,"column":22},"source":"node_modules/lusca/lib/csrf.js","original":{"line":63,"column":22}},{"generated":{"line":61,"column":25},"source":"node_modules/lusca/lib/csrf.js","original":{"line":63,"column":4}},{"name":"token","generated":{"line":61,"column":27},"source":"node_modules/lusca/lib/csrf.js","original":{"line":63,"column":27}},{"generated":{"line":61,"column":32},"source":"node_modules/lusca/lib/csrf.js","original":{"line":63,"column":4}},{"generated":{"line":61,"column":34},"source":"node_modules/lusca/lib/csrf.js","original":{"line":63,"column":34}},{"name":"res","generated":{"line":62,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":64,"column":8}},{"name":"locals","generated":{"line":62,"column":12},"source":"node_modules/lusca/lib/csrf.js","original":{"line":64,"column":12}},{"generated":{"line":62,"column":18},"source":"node_modules/lusca/lib/csrf.js","original":{"line":64,"column":8}},{"name":"key","generated":{"line":62,"column":19},"source":"node_modules/lusca/lib/csrf.js","original":{"line":64,"column":19}},{"generated":{"line":62,"column":22},"source":"node_modules/lusca/lib/csrf.js","original":{"line":64,"column":8}},{"name":"token","generated":{"line":62,"column":26},"source":"node_modules/lusca/lib/csrf.js","original":{"line":64,"column":26}},{"generated":{"line":62,"column":31},"source":"node_modules/lusca/lib/csrf.js","original":{"line":64,"column":8}},{"generated":{"line":64,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":66,"column":8}},{"name":"cookie","generated":{"line":64,"column":12},"source":"node_modules/lusca/lib/csrf.js","original":{"line":66,"column":12}},{"name":"cookie","generated":{"line":64,"column":22},"source":"node_modules/lusca/lib/csrf.js","original":{"line":66,"column":22}},{"name":"name","generated":{"line":64,"column":29},"source":"node_modules/lusca/lib/csrf.js","original":{"line":66,"column":29}},{"generated":{"line":64,"column":33},"source":"node_modules/lusca/lib/csrf.js","original":{"line":66,"column":8}},{"generated":{"line":64,"column":35},"source":"node_modules/lusca/lib/csrf.js","original":{"line":66,"column":35}},{"name":"res","generated":{"line":65,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":67,"column":12}},{"name":"cookie","generated":{"line":65,"column":16},"source":"node_modules/lusca/lib/csrf.js","original":{"line":67,"column":16}},{"generated":{"line":65,"column":22},"source":"node_modules/lusca/lib/csrf.js","original":{"line":67,"column":12}},{"name":"cookie","generated":{"line":65,"column":23},"source":"node_modules/lusca/lib/csrf.js","original":{"line":67,"column":23}},{"name":"name","generated":{"line":65,"column":30},"source":"node_modules/lusca/lib/csrf.js","original":{"line":67,"column":30}},{"generated":{"line":65,"column":34},"source":"node_modules/lusca/lib/csrf.js","original":{"line":67,"column":12}},{"name":"token","generated":{"line":65,"column":36},"source":"node_modules/lusca/lib/csrf.js","original":{"line":67,"column":36}},{"generated":{"line":65,"column":41},"source":"node_modules/lusca/lib/csrf.js","original":{"line":67,"column":12}},{"name":"cookie","generated":{"line":65,"column":43},"source":"node_modules/lusca/lib/csrf.js","original":{"line":67,"column":43}},{"name":"options","generated":{"line":65,"column":50},"source":"node_modules/lusca/lib/csrf.js","original":{"line":67,"column":50}},{"generated":{"line":65,"column":57},"source":"node_modules/lusca/lib/csrf.js","original":{"line":67,"column":43}},{"generated":{"line":65,"column":61},"source":"node_modules/lusca/lib/csrf.js","original":{"line":67,"column":61}},{"generated":{"line":65,"column":63},"source":"node_modules/lusca/lib/csrf.js","original":{"line":67,"column":12}},{"generated":{"line":66,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":68,"column":9}},{"generated":{"line":67,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":69,"column":5}},{"generated":{"line":69,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":72,"column":4}},{"generated":{"line":69,"column":11},"source":"node_modules/lusca/lib/csrf.js","original":{"line":72,"column":11}},{"name":"checkCsrf","generated":{"line":69,"column":20},"source":"node_modules/lusca/lib/csrf.js","original":{"line":72,"column":20}},{"generated":{"line":69,"column":29},"source":"node_modules/lusca/lib/csrf.js","original":{"line":72,"column":11}},{"name":"req","generated":{"line":69,"column":30},"source":"node_modules/lusca/lib/csrf.js","original":{"line":72,"column":30}},{"generated":{"line":69,"column":33},"source":"node_modules/lusca/lib/csrf.js","original":{"line":72,"column":11}},{"name":"res","generated":{"line":69,"column":35},"source":"node_modules/lusca/lib/csrf.js","original":{"line":72,"column":35}},{"generated":{"line":69,"column":38},"source":"node_modules/lusca/lib/csrf.js","original":{"line":72,"column":11}},{"name":"next","generated":{"line":69,"column":40},"source":"node_modules/lusca/lib/csrf.js","original":{"line":72,"column":40}},{"generated":{"line":69,"column":44},"source":"node_modules/lusca/lib/csrf.js","original":{"line":72,"column":11}},{"generated":{"line":69,"column":46},"source":"node_modules/lusca/lib/csrf.js","original":{"line":72,"column":46}},{"generated":{"line":70,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":73,"column":8}},{"name":"method","generated":{"line":70,"column":12},"source":"node_modules/lusca/lib/csrf.js","original":{"line":73,"column":12}},{"generated":{"line":70,"column":18},"source":"node_modules/lusca/lib/csrf.js","original":{"line":73,"column":8}},{"name":"_token","generated":{"line":70,"column":20},"source":"node_modules/lusca/lib/csrf.js","original":{"line":73,"column":20}},{"generated":{"line":70,"column":26},"source":"node_modules/lusca/lib/csrf.js","original":{"line":73,"column":8}},{"name":"errmsg","generated":{"line":70,"column":28},"source":"node_modules/lusca/lib/csrf.js","original":{"line":73,"column":28}},{"generated":{"line":70,"column":34},"source":"node_modules/lusca/lib/csrf.js","original":{"line":73,"column":8}},{"generated":{"line":72,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":75,"column":8}},{"name":"csrf","generated":{"line":72,"column":12},"source":"node_modules/lusca/lib/csrf.js","original":{"line":75,"column":12}},{"name":"getCsrf","generated":{"line":72,"column":19},"source":"node_modules/lusca/lib/csrf.js","original":{"line":75,"column":19}},{"name":"req","generated":{"line":72,"column":27},"source":"node_modules/lusca/lib/csrf.js","original":{"line":75,"column":27}},{"generated":{"line":72,"column":30},"source":"node_modules/lusca/lib/csrf.js","original":{"line":75,"column":19}},{"name":"secret","generated":{"line":72,"column":32},"source":"node_modules/lusca/lib/csrf.js","original":{"line":75,"column":32}},{"generated":{"line":72,"column":38},"source":"node_modules/lusca/lib/csrf.js","original":{"line":75,"column":19}},{"generated":{"line":72,"column":39},"source":"node_modules/lusca/lib/csrf.js","original":{"line":75,"column":8}},{"name":"setToken","generated":{"line":74,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":77,"column":8}},{"name":"res","generated":{"line":74,"column":17},"source":"node_modules/lusca/lib/csrf.js","original":{"line":77,"column":17}},{"generated":{"line":74,"column":20},"source":"node_modules/lusca/lib/csrf.js","original":{"line":77,"column":8}},{"name":"csrf","generated":{"line":74,"column":22},"source":"node_modules/lusca/lib/csrf.js","original":{"line":77,"column":22}},{"name":"token","generated":{"line":74,"column":27},"source":"node_modules/lusca/lib/csrf.js","original":{"line":77,"column":27}},{"generated":{"line":74,"column":32},"source":"node_modules/lusca/lib/csrf.js","original":{"line":77,"column":8}},{"name":"req","generated":{"line":76,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":79,"column":8}},{"name":"csrfToken","generated":{"line":76,"column":12},"source":"node_modules/lusca/lib/csrf.js","original":{"line":79,"column":12}},{"generated":{"line":76,"column":21},"source":"node_modules/lusca/lib/csrf.js","original":{"line":79,"column":8}},{"generated":{"line":76,"column":24},"source":"node_modules/lusca/lib/csrf.js","original":{"line":79,"column":24}},{"name":"csrfToken","generated":{"line":76,"column":33},"source":"node_modules/lusca/lib/csrf.js","original":{"line":79,"column":33}},{"generated":{"line":76,"column":42},"source":"node_modules/lusca/lib/csrf.js","original":{"line":79,"column":24}},{"generated":{"line":76,"column":45},"source":"node_modules/lusca/lib/csrf.js","original":{"line":79,"column":45}},{"generated":{"line":77,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":80,"column":12}},{"name":"newCsrf","generated":{"line":77,"column":16},"source":"node_modules/lusca/lib/csrf.js","original":{"line":80,"column":16}},{"name":"getCsrf","generated":{"line":77,"column":26},"source":"node_modules/lusca/lib/csrf.js","original":{"line":80,"column":26}},{"name":"req","generated":{"line":77,"column":34},"source":"node_modules/lusca/lib/csrf.js","original":{"line":80,"column":34}},{"generated":{"line":77,"column":37},"source":"node_modules/lusca/lib/csrf.js","original":{"line":80,"column":26}},{"name":"secret","generated":{"line":77,"column":39},"source":"node_modules/lusca/lib/csrf.js","original":{"line":80,"column":39}},{"generated":{"line":77,"column":45},"source":"node_modules/lusca/lib/csrf.js","original":{"line":80,"column":26}},{"generated":{"line":77,"column":46},"source":"node_modules/lusca/lib/csrf.js","original":{"line":80,"column":12}},{"generated":{"line":78,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":81,"column":12}},{"name":"csrf","generated":{"line":78,"column":16},"source":"node_modules/lusca/lib/csrf.js","original":{"line":81,"column":16}},{"name":"secret","generated":{"line":78,"column":21},"source":"node_modules/lusca/lib/csrf.js","original":{"line":81,"column":21}},{"generated":{"line":78,"column":27},"source":"node_modules/lusca/lib/csrf.js","original":{"line":81,"column":16}},{"name":"newCsrf","generated":{"line":78,"column":31},"source":"node_modules/lusca/lib/csrf.js","original":{"line":81,"column":31}},{"name":"secret","generated":{"line":78,"column":39},"source":"node_modules/lusca/lib/csrf.js","original":{"line":81,"column":39}},{"generated":{"line":78,"column":45},"source":"node_modules/lusca/lib/csrf.js","original":{"line":81,"column":16}},{"name":"timeSafeCompare","generated":{"line":78,"column":49},"source":"node_modules/lusca/lib/csrf.js","original":{"line":82,"column":16}},{"name":"csrf","generated":{"line":78,"column":65},"source":"node_modules/lusca/lib/csrf.js","original":{"line":82,"column":32}},{"name":"secret","generated":{"line":78,"column":70},"source":"node_modules/lusca/lib/csrf.js","original":{"line":82,"column":37}},{"generated":{"line":78,"column":76},"source":"node_modules/lusca/lib/csrf.js","original":{"line":82,"column":16}},{"name":"newCsrf","generated":{"line":78,"column":78},"source":"node_modules/lusca/lib/csrf.js","original":{"line":82,"column":45}},{"name":"secret","generated":{"line":78,"column":86},"source":"node_modules/lusca/lib/csrf.js","original":{"line":82,"column":53}},{"generated":{"line":78,"column":92},"source":"node_modules/lusca/lib/csrf.js","original":{"line":82,"column":16}},{"generated":{"line":78,"column":93},"source":"node_modules/lusca/lib/csrf.js","original":{"line":81,"column":12}},{"generated":{"line":78,"column":95},"source":"node_modules/lusca/lib/csrf.js","original":{"line":82,"column":62}},{"generated":{"line":79,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":83,"column":16}},{"name":"csrf","generated":{"line":79,"column":23},"source":"node_modules/lusca/lib/csrf.js","original":{"line":83,"column":23}},{"name":"token","generated":{"line":79,"column":28},"source":"node_modules/lusca/lib/csrf.js","original":{"line":83,"column":28}},{"generated":{"line":79,"column":33},"source":"node_modules/lusca/lib/csrf.js","original":{"line":83,"column":16}},{"generated":{"line":80,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":84,"column":13}},{"name":"csrf","generated":{"line":82,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":86,"column":12}},{"name":"newCsrf","generated":{"line":82,"column":19},"source":"node_modules/lusca/lib/csrf.js","original":{"line":86,"column":19}},{"generated":{"line":82,"column":26},"source":"node_modules/lusca/lib/csrf.js","original":{"line":86,"column":12}},{"name":"setToken","generated":{"line":83,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":87,"column":12}},{"name":"res","generated":{"line":83,"column":21},"source":"node_modules/lusca/lib/csrf.js","original":{"line":87,"column":21}},{"generated":{"line":83,"column":24},"source":"node_modules/lusca/lib/csrf.js","original":{"line":87,"column":12}},{"name":"csrf","generated":{"line":83,"column":26},"source":"node_modules/lusca/lib/csrf.js","original":{"line":87,"column":26}},{"name":"token","generated":{"line":83,"column":31},"source":"node_modules/lusca/lib/csrf.js","original":{"line":87,"column":31}},{"generated":{"line":83,"column":36},"source":"node_modules/lusca/lib/csrf.js","original":{"line":87,"column":12}},{"generated":{"line":84,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":88,"column":12}},{"name":"csrf","generated":{"line":84,"column":19},"source":"node_modules/lusca/lib/csrf.js","original":{"line":88,"column":19}},{"name":"token","generated":{"line":84,"column":24},"source":"node_modules/lusca/lib/csrf.js","original":{"line":88,"column":24}},{"generated":{"line":84,"column":29},"source":"node_modules/lusca/lib/csrf.js","original":{"line":88,"column":12}},{"generated":{"line":85,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":89,"column":9}},{"generated":{"line":85,"column":9},"source":"node_modules/lusca/lib/csrf.js","original":{"line":79,"column":8}},{"generated":{"line":87,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":91,"column":8}},{"name":"method","generated":{"line":88,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":92,"column":8}},{"name":"req","generated":{"line":88,"column":17},"source":"node_modules/lusca/lib/csrf.js","original":{"line":92,"column":17}},{"name":"method","generated":{"line":88,"column":21},"source":"node_modules/lusca/lib/csrf.js","original":{"line":92,"column":21}},{"generated":{"line":88,"column":27},"source":"node_modules/lusca/lib/csrf.js","original":{"line":92,"column":8}},{"generated":{"line":90,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":94,"column":8}},{"name":"method","generated":{"line":90,"column":12},"source":"node_modules/lusca/lib/csrf.js","original":{"line":94,"column":12}},{"generated":{"line":90,"column":23},"source":"node_modules/lusca/lib/csrf.js","original":{"line":94,"column":23}},{"generated":{"line":90,"column":28},"source":"node_modules/lusca/lib/csrf.js","original":{"line":94,"column":12}},{"name":"method","generated":{"line":90,"column":32},"source":"node_modules/lusca/lib/csrf.js","original":{"line":94,"column":32}},{"generated":{"line":90,"column":43},"source":"node_modules/lusca/lib/csrf.js","original":{"line":94,"column":43}},{"generated":{"line":90,"column":49},"source":"node_modules/lusca/lib/csrf.js","original":{"line":94,"column":12}},{"name":"method","generated":{"line":90,"column":53},"source":"node_modules/lusca/lib/csrf.js","original":{"line":94,"column":53}},{"generated":{"line":90,"column":64},"source":"node_modules/lusca/lib/csrf.js","original":{"line":94,"column":64}},{"generated":{"line":90,"column":73},"source":"node_modules/lusca/lib/csrf.js","original":{"line":94,"column":8}},{"generated":{"line":90,"column":75},"source":"node_modules/lusca/lib/csrf.js","original":{"line":94,"column":75}},{"generated":{"line":91,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":95,"column":12}},{"name":"next","generated":{"line":91,"column":19},"source":"node_modules/lusca/lib/csrf.js","original":{"line":95,"column":19}},{"generated":{"line":91,"column":25},"source":"node_modules/lusca/lib/csrf.js","original":{"line":95,"column":12}},{"generated":{"line":92,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":96,"column":9}},{"generated":{"line":94,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":98,"column":8}},{"name":"_token","generated":{"line":95,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":8}},{"name":"req","generated":{"line":95,"column":17},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":18}},{"name":"body","generated":{"line":95,"column":21},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":22}},{"generated":{"line":95,"column":25},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":18}},{"name":"req","generated":{"line":95,"column":29},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":30}},{"name":"body","generated":{"line":95,"column":33},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":34}},{"generated":{"line":95,"column":37},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":30}},{"name":"key","generated":{"line":95,"column":38},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":39}},{"generated":{"line":95,"column":41},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":30}},{"generated":{"line":95,"column":42},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":17}},{"name":"req","generated":{"line":95,"column":46},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":48}},{"name":"headers","generated":{"line":95,"column":50},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":52}},{"generated":{"line":95,"column":57},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":48}},{"name":"header","generated":{"line":95,"column":58},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":60}},{"name":"toLowerCase","generated":{"line":95,"column":65},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":67}},{"generated":{"line":95,"column":76},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":60}},{"generated":{"line":95,"column":78},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":48}},{"generated":{"line":95,"column":79},"source":"node_modules/lusca/lib/csrf.js","original":{"line":99,"column":8}},{"generated":{"line":97,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":101,"column":8}},{"name":"csrf","generated":{"line":97,"column":12},"source":"node_modules/lusca/lib/csrf.js","original":{"line":101,"column":12}},{"name":"validate","generated":{"line":97,"column":17},"source":"node_modules/lusca/lib/csrf.js","original":{"line":101,"column":17}},{"generated":{"line":97,"column":25},"source":"node_modules/lusca/lib/csrf.js","original":{"line":101,"column":12}},{"name":"req","generated":{"line":97,"column":26},"source":"node_modules/lusca/lib/csrf.js","original":{"line":101,"column":26}},{"generated":{"line":97,"column":29},"source":"node_modules/lusca/lib/csrf.js","original":{"line":101,"column":12}},{"name":"_token","generated":{"line":97,"column":31},"source":"node_modules/lusca/lib/csrf.js","original":{"line":101,"column":31}},{"generated":{"line":97,"column":37},"source":"node_modules/lusca/lib/csrf.js","original":{"line":101,"column":12}},{"generated":{"line":97,"column":38},"source":"node_modules/lusca/lib/csrf.js","original":{"line":101,"column":8}},{"generated":{"line":97,"column":40},"source":"node_modules/lusca/lib/csrf.js","original":{"line":101,"column":40}},{"name":"next","generated":{"line":98,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":102,"column":12}},{"generated":{"line":99,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":103,"column":9}},{"generated":{"line":99,"column":9},"source":"node_modules/lusca/lib/csrf.js","original":{"line":101,"column":8}},{"generated":{"line":99,"column":15},"source":"node_modules/lusca/lib/csrf.js","original":{"line":103,"column":15}},{"name":"res","generated":{"line":100,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":104,"column":12}},{"name":"statusCode","generated":{"line":100,"column":16},"source":"node_modules/lusca/lib/csrf.js","original":{"line":104,"column":16}},{"generated":{"line":100,"column":26},"source":"node_modules/lusca/lib/csrf.js","original":{"line":104,"column":12}},{"generated":{"line":100,"column":29},"source":"node_modules/lusca/lib/csrf.js","original":{"line":104,"column":29}},{"generated":{"line":100,"column":32},"source":"node_modules/lusca/lib/csrf.js","original":{"line":104,"column":12}},{"generated":{"line":102,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":106,"column":12}},{"generated":{"line":102,"column":16},"source":"node_modules/lusca/lib/csrf.js","original":{"line":106,"column":16}},{"name":"_token","generated":{"line":102,"column":17},"source":"node_modules/lusca/lib/csrf.js","original":{"line":106,"column":17}},{"generated":{"line":102,"column":23},"source":"node_modules/lusca/lib/csrf.js","original":{"line":106,"column":12}},{"generated":{"line":102,"column":25},"source":"node_modules/lusca/lib/csrf.js","original":{"line":106,"column":25}},{"name":"errmsg","generated":{"line":103,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":107,"column":16}},{"generated":{"line":103,"column":25},"source":"node_modules/lusca/lib/csrf.js","original":{"line":107,"column":25}},{"generated":{"line":103,"column":45},"source":"node_modules/lusca/lib/csrf.js","original":{"line":107,"column":16}},{"generated":{"line":104,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":108,"column":13}},{"generated":{"line":104,"column":13},"source":"node_modules/lusca/lib/csrf.js","original":{"line":106,"column":12}},{"generated":{"line":104,"column":19},"source":"node_modules/lusca/lib/csrf.js","original":{"line":108,"column":19}},{"name":"errmsg","generated":{"line":105,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":109,"column":16}},{"generated":{"line":105,"column":25},"source":"node_modules/lusca/lib/csrf.js","original":{"line":109,"column":25}},{"generated":{"line":105,"column":46},"source":"node_modules/lusca/lib/csrf.js","original":{"line":109,"column":16}},{"generated":{"line":106,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":110,"column":13}},{"name":"next","generated":{"line":108,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":112,"column":12}},{"generated":{"line":108,"column":17},"source":"node_modules/lusca/lib/csrf.js","original":{"line":112,"column":17}},{"name":"Error","generated":{"line":108,"column":21},"source":"node_modules/lusca/lib/csrf.js","original":{"line":112,"column":21}},{"generated":{"line":108,"column":26},"source":"node_modules/lusca/lib/csrf.js","original":{"line":112,"column":17}},{"name":"errmsg","generated":{"line":108,"column":27},"source":"node_modules/lusca/lib/csrf.js","original":{"line":112,"column":27}},{"generated":{"line":108,"column":33},"source":"node_modules/lusca/lib/csrf.js","original":{"line":112,"column":17}},{"generated":{"line":108,"column":34},"source":"node_modules/lusca/lib/csrf.js","original":{"line":112,"column":12}},{"generated":{"line":109,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":113,"column":9}},{"generated":{"line":110,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":114,"column":5}},{"generated":{"line":110,"column":5},"source":"node_modules/lusca/lib/csrf.js","original":{"line":72,"column":4}},{"generated":{"line":111,"column":0},"source":"node_modules/lusca/lib/csrf.js","original":{"line":115,"column":1}},{"generated":{"line":111,"column":1},"source":"node_modules/lusca/lib/csrf.js","original":{"line":16,"column":0}}],"sources":{"node_modules/lusca/lib/csrf.js":"'use strict';\n\n\nvar token = require('./token'),\n    timeSafeCompare = require('tsscmp');\n\n\n/**\n * CSRF\n * https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)\n * @param {Object} options\n *    key {String} The name of the CSRF token in the model. Default \"_csrf\".\n *    impl {Object} An object with create/validate methods for custom tokens. Optional.\n *    header {String} The name of the response header containing the CSRF token. Default \"x-csrf-token\".\n */\nmodule.exports = function (options) {\n    var impl, key, header, secret, cookie;\n\n    options = options || {};\n\n    if (options.angular) {\n        options.header = 'X-XSRF-TOKEN';\n        options.cookie = {\n            name: 'XSRF-TOKEN',\n            options: options.cookie && options.cookie.options\n        };\n    }\n\n    key = options.key || '_csrf';\n    impl = options.impl || token;\n    header = options.header || 'x-csrf-token';\n    secret = options.secret || '_csrfSecret';\n\n    // Check if cookie is string or object\n    if (typeof options.cookie === 'string') {\n        cookie = {\n            name: options.cookie,\n        };\n    } else {\n        cookie = {\n            name: options.cookie && options.cookie.name\n        };\n    }\n\n    // Set cookie options\n    cookie.options = options.cookie && options.cookie.options || {};\n\n    function getCsrf(req, secret) {\n        var _impl, validate, _token, _secret;\n\n        _impl = impl.create(req, secret);\n        validate = impl.validate || _impl.validate;\n        _token = _impl.token || _impl;\n        _secret = _impl.secret;\n\n        return {\n            validate: validate,\n            token: _token,\n            secret: _secret\n        };\n    }\n\n    function setToken(res, token) {\n        res.locals[key] = token;\n\n        if (cookie && cookie.name) {\n            res.cookie(cookie.name, token, cookie.options || {});\n        }\n    }\n\n\n    return function checkCsrf(req, res, next) {\n        var method, _token, errmsg;\n\n        var csrf = getCsrf(req, secret);\n\n        setToken(res, csrf.token);\n\n        req.csrfToken = function csrfToken() {\n            var newCsrf = getCsrf(req, secret);\n            if (csrf.secret && newCsrf.secret &&\n                timeSafeCompare(csrf.secret, newCsrf.secret)) {\n                return csrf.token;\n            }\n\n            csrf = newCsrf;\n            setToken(res, csrf.token);\n            return csrf.token;\n        };\n\n        // Move along for safe verbs\n        method = req.method;\n\n        if (method === 'GET' || method === 'HEAD' || method === 'OPTIONS') {\n            return next();\n        }\n\n        // Validate token\n        _token = (req.body && req.body[key]) || req.headers[header.toLowerCase()];\n\n        if (csrf.validate(req, _token)) {\n            next();\n        } else {\n            res.statusCode = 403;\n\n            if (!_token) {\n                errmsg = 'CSRF token missing';\n            } else {\n                errmsg = 'CSRF token mismatch';\n            }\n\n            next(new Error(errmsg));\n        }\n    };\n};\n"},"lineCount":null}},"hash":"461cb51b7d33606d50b5875c9ab0576a","cacheData":{"env":{}}}